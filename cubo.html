<html>

<head>
<title>Aubengine</title>
<meta http-equiv='content-type' content='text/html; charset=ISO-8859-1'>
<script type='text/javascript' src='dist/dependencies.js'></script>
<script type='text/javascript' src='dist/Aubengine.js'></script>
<script id="shader-vs" type="x-shader/x-vertex">
//geometry
attribute vec3 aVertexPosition;
attribute vec3 aVertexNormal;
attribute vec4 aVertexColor;
uniform bool uUseVertexColor;
uniform vec4 uMaterialDiffuse;
uniform vec4 uMaterialAmbient;
uniform float uAlpha;

//matrices
uniform mat4 uMVMatrix;
uniform mat4 uPMatrix;
uniform mat4 uNMatrix;

//lights
uniform vec3 uLightPosition;
uniform vec4 uLightAmbient;
uniform vec4 uLightDiffuse;
uniform bool uUseLambert;

//varyings
varying vec4 vColor;


void main(void) {

 //Transformed vertex position
 vec4 vertex = uMVMatrix * vec4(aVertexPosition, 1.0);

 float lambertTerm = 1.0;

 if (uUseLambert){
	//Transformed normal position
	vec3 normal = vec3(uNMatrix * vec4(aVertexNormal, 1.0));

	//light direction: pointing at the origin
	vec3 lightDirection = normalize(-uLightPosition);

	//weighting factor
	lambertTerm = max(dot(normal,-lightDirection),0.20);
 }

 //reading vertex color
 vec4 Ia = uLightAmbient * uMaterialAmbient;
 vec4 Id = vec4(0.0);

 if (uUseVertexColor){
	Id = uLightDiffuse * aVertexColor * lambertTerm;
 }
 else {
	Id = uLightDiffuse * uMaterialDiffuse * lambertTerm;
 }

 vColor = Ia + Id;
 vColor.a = uAlpha;

 //Final vertex position
 gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);

}
</script>

<script id="shader-fs" type="x-shader/x-fragment">
#ifdef GL_ES
precision highp float;
#endif

//geometry
uniform vec4 uMaterialDiffuse;
uniform bool uWireframe;

//varying
varying vec4 vColor;

void main(void)
{
	if(uWireframe){
		gl_FragColor = uMaterialDiffuse;
	}
	else{
    	gl_FragColor = vColor;
    }

}
</script>

<script id='code-js' type="text/javascript">


var aubengine = null;
function runWebGLApp() {
    aubengine = new Aubengine("canvas")
    aubengine.setUpEnvironment();
    aubengine.addCamera();
    // aubengine.addLight('light1',[-25,25,-25], [0.4,0.4,0.4], [1.0,1.0,1.0], [0.8,0.8,0.8]);
    // aubengine.addLight('light2',[25,25,-25], [0.4,0.4,0.4], [1.0,1.0,1.0], [0.8,0.8,0.8]);
    // aubengine.addLight('light3',[-25,25,25], [0.4,0.4,0.4], [1.0,1.0,1.0], [0.8,0.8,0.8]);
    // aubengine.addLight('light4',[-25,25,-25], [0.4,0.4,0.4], [1.0,1.0,1.0], [0.8,0.8,0.8]);
    aubengine.loadProgram(false);
    aubengine.addModel('models/geometry/ball.json','cube1', {hidden:false});
    aubengine.addModel('models/geometry/simpleCube.json','cube2', {hidden:false});
}

</script>
</head>

<body onLoad='runWebGLApp()'>
<div id='top'>
<h1>Aubengine</h1>
<h2>Game Engine in WebGL</h2>
<button id="draw">draw</button>
<p></p>
</div>

<div id='contents'>
<div id='canvasContainer'>
<canvas id='canvas' width='480' height='400'>
Your browser does not support the HTML5 canvas element.
</canvas>
</div>
</div>
<script>
document.getElementById('draw').addEventListener('click', function(event) {
  aubengine.draw();
})
</script>
</body>
</html>
